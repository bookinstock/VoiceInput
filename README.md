# VoiceInput - Mac 语音输入应用

一个类似 Typeless 的 Mac 语音输入工具，支持通过快捷键触发语音识别，将语音转换为文字并自动输入到当前活跃的文本框中。

## 功能特点

- **全局快捷键触发**: 按下快捷键开始录音，再按停止（默认: ⌘⇧V）
- **中英文语音识别**: 支持中文和英文语音识别，可随时切换
- **菜单栏应用**: 在系统菜单栏显示，不占用 Dock 空间
- **自动文字输入**: 识别完成后自动将文字输入到当前焦点位置
- **自定义快捷键**: 支持自定义快捷键组合

## 系统要求

- macOS 13.0 (Ventura) 或更高版本
- 需要授予以下权限：
  - 麦克风权限
  - 语音识别权限
  - 辅助功能权限（用于文字输入）

## 安装说明

### 从 Xcode 构建

1. 用 Xcode 打开 `VoiceInput.xcodeproj`
2. 选择你的开发者账户进行签名
3. 点击 Build & Run (⌘R)

### 首次运行

首次运行时，应用会请求以下权限：

1. **麦克风权限**: 用于录制语音
2. **语音识别权限**: 用于将语音转换为文字
3. **辅助功能权限**: 用于将文字输入到其他应用

请在系统弹窗中点击"允许"授予这些权限。

## 使用方法

### 基本使用

1. 启动应用后，菜单栏会出现一个麦克风图标
2. 将光标放在你想输入文字的地方（任何文本框）
3. 按下快捷键（默认 ⌘⇧V）开始录音
4. 说出你想输入的内容
5. 再次按下快捷键停止录音
6. 识别的文字会自动输入到当前位置

### 菜单栏操作

- **左键点击**: 切换录音状态（开始/停止）
- **Option + 左键点击**: 打开设置面板
- **右键点击**: 显示快捷菜单

### 设置选项

在设置面板中，你可以：

- 切换识别语言（中文/英文）
- 自定义触发快捷键
- 查看和管理权限状态

### 自定义快捷键

1. 打开设置面板
2. 在"快捷键"区域点击当前快捷键
3. 按下你想要的快捷键组合（需包含至少一个修饰键：⌘/⌥/⌃/⇧）
4. 点击"保存"确认更改

## 项目结构

```
VoiceInput/
├── VoiceInput.xcodeproj          # Xcode 项目文件
├── VoiceInput/
│   ├── VoiceInputApp.swift       # 应用入口
│   ├── AppDelegate.swift         # 应用代理，处理菜单栏和状态
│   ├── ContentView.swift         # 设置界面
│   ├── Services/
│   │   ├── SpeechRecognizer.swift    # 语音识别服务
│   │   ├── HotKeyManager.swift       # 全局快捷键管理
│   │   └── TextInputSimulator.swift  # 文本输入模拟
│   ├── Models/
│   │   └── AppSettings.swift     # 应用设置模型
│   └── Resources/
│       └── Assets.xcassets       # 图标资源
└── README.md                     # 本文件
```

## 技术实现

- **语音识别**: 使用 Apple Speech Framework (SFSpeechRecognizer)
- **全局快捷键**: 使用 Carbon API (RegisterEventHotKey)
- **文字输入**: 使用 CGEvent 模拟键盘输入
- **UI**: SwiftUI + AppKit

## 故障排除

### 语音识别不工作

1. 检查是否授予了麦克风权限
2. 检查是否授予了语音识别权限
3. 确保网络连接正常（语音识别需要网络）

### 文字无法输入

1. 检查是否授予了辅助功能权限
2. 在"系统偏好设置 > 安全性与隐私 > 隐私 > 辅助功能"中确认 VoiceInput 已被勾选

### 快捷键不响应

1. 检查快捷键是否与其他应用冲突
2. 尝试更换其他快捷键组合

## 许可证

MIT License

## 致谢

灵感来源于 [Typeless](https://typeless.app) 应用。

